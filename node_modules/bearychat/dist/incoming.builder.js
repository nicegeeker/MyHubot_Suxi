'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Builder = function () {
  function Builder() {
    _classCallCheck(this, Builder);

    this.reset();
  }

  _createClass(Builder, [{
    key: 'reset',
    value: function reset() {
      this.text = null;
      this.markdown = false;
      this.channel = null;
      this.attachments = [];
    }
  }, {
    key: 'to',
    value: function to(channel) {
      this.channel = channel;

      return this;
    }
  }, {
    key: 'withText',
    value: function withText(text) {
      var useMarkdown = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      this.text = text;
      this.markdown = useMarkdown;

      return this;
    }
  }, {
    key: 'withMarkdown',
    value: function withMarkdown(text) {
      return this.withText(text, true);
    }
  }, {
    key: 'withAttachment',
    value: function withAttachment(attachment) {
      this.attachments.push(attachment);

      return this;
    }
  }, {
    key: 'build',
    value: function build() {
      var message = {
        text: this.text,
        markdown: this.markdown
      };

      if (this.channel) {
        message.channel = this.channel;
      }

      if (this.attachments.length > 0) {
        message.attachments = [];
        this.attachments.forEach(function (attachment) {
          if (!attachment.title && !attachment.text) {
            throw new Error('attachment title or text is required');
          }
          message.attachments.push(attachment);
        });
      }

      return message;
    }
  }]);

  return Builder;
}();

exports.default = {
  withText: function withText(text, useMarkdown) {
    return new Builder().withText(text, useMarkdown);
  },
  withMarkdown: function withMarkdown(text) {
    return new Builder().withMarkdown(text);
  }
};
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmNvbWluZy5idWlsZGVyLmpzIl0sIm5hbWVzIjpbIkJ1aWxkZXIiLCJyZXNldCIsInRleHQiLCJtYXJrZG93biIsImNoYW5uZWwiLCJhdHRhY2htZW50cyIsInVzZU1hcmtkb3duIiwid2l0aFRleHQiLCJhdHRhY2htZW50IiwicHVzaCIsIm1lc3NhZ2UiLCJsZW5ndGgiLCJmb3JFYWNoIiwidGl0bGUiLCJFcnJvciIsIndpdGhNYXJrZG93biJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztJQUFNQSxPO0FBRUoscUJBQWM7QUFBQTs7QUFDWixTQUFLQyxLQUFMO0FBQ0Q7Ozs7NEJBRU87QUFDTixXQUFLQyxJQUFMLEdBQVksSUFBWjtBQUNBLFdBQUtDLFFBQUwsR0FBZ0IsS0FBaEI7QUFDQSxXQUFLQyxPQUFMLEdBQWUsSUFBZjtBQUNBLFdBQUtDLFdBQUwsR0FBbUIsRUFBbkI7QUFDRDs7O3VCQUVFRCxPLEVBQVM7QUFDVixXQUFLQSxPQUFMLEdBQWVBLE9BQWY7O0FBRUEsYUFBTyxJQUFQO0FBQ0Q7Ozs2QkFFUUYsSSxFQUEyQjtBQUFBLFVBQXJCSSxXQUFxQix1RUFBUCxLQUFPOztBQUNsQyxXQUFLSixJQUFMLEdBQVlBLElBQVo7QUFDQSxXQUFLQyxRQUFMLEdBQWdCRyxXQUFoQjs7QUFFQSxhQUFPLElBQVA7QUFDRDs7O2lDQUVZSixJLEVBQU07QUFDakIsYUFBTyxLQUFLSyxRQUFMLENBQWNMLElBQWQsRUFBb0IsSUFBcEIsQ0FBUDtBQUNEOzs7bUNBRWNNLFUsRUFBWTtBQUN6QixXQUFLSCxXQUFMLENBQWlCSSxJQUFqQixDQUFzQkQsVUFBdEI7O0FBRUEsYUFBTyxJQUFQO0FBQ0Q7Ozs0QkFFTztBQUNOLFVBQU1FLFVBQVU7QUFDZFIsY0FBTSxLQUFLQSxJQURHO0FBRWRDLGtCQUFVLEtBQUtBO0FBRkQsT0FBaEI7O0FBS0EsVUFBSSxLQUFLQyxPQUFULEVBQWtCO0FBQ2hCTSxnQkFBUU4sT0FBUixHQUFrQixLQUFLQSxPQUF2QjtBQUNEOztBQUVELFVBQUksS0FBS0MsV0FBTCxDQUFpQk0sTUFBakIsR0FBMEIsQ0FBOUIsRUFBaUM7QUFDL0JELGdCQUFRTCxXQUFSLEdBQXNCLEVBQXRCO0FBQ0EsYUFBS0EsV0FBTCxDQUFpQk8sT0FBakIsQ0FBeUIsVUFBQ0osVUFBRCxFQUFnQjtBQUN2QyxjQUFJLENBQUNBLFdBQVdLLEtBQVosSUFBcUIsQ0FBQ0wsV0FBV04sSUFBckMsRUFBMkM7QUFDekMsa0JBQU0sSUFBSVksS0FBSixDQUFVLHNDQUFWLENBQU47QUFDRDtBQUNESixrQkFBUUwsV0FBUixDQUFvQkksSUFBcEIsQ0FBeUJELFVBQXpCO0FBQ0QsU0FMRDtBQU1EOztBQUVELGFBQU9FLE9BQVA7QUFDRDs7Ozs7O2tCQUlZO0FBQ2JILFlBQVUsa0JBQUNMLElBQUQsRUFBT0ksV0FBUDtBQUFBLFdBQXdCLElBQUlOLE9BQUosRUFBRCxDQUFnQk8sUUFBaEIsQ0FBeUJMLElBQXpCLEVBQStCSSxXQUEvQixDQUF2QjtBQUFBLEdBREc7QUFFYlMsZ0JBQWM7QUFBQSxXQUFTLElBQUlmLE9BQUosRUFBRCxDQUFnQmUsWUFBaEIsQ0FBNkJiLElBQTdCLENBQVI7QUFBQTtBQUZELEMiLCJmaWxlIjoiaW5jb21pbmcuYnVpbGRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEJ1aWxkZXIge1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucmVzZXQoKTtcbiAgfVxuXG4gIHJlc2V0KCkge1xuICAgIHRoaXMudGV4dCA9IG51bGw7XG4gICAgdGhpcy5tYXJrZG93biA9IGZhbHNlO1xuICAgIHRoaXMuY2hhbm5lbCA9IG51bGw7XG4gICAgdGhpcy5hdHRhY2htZW50cyA9IFtdO1xuICB9XG5cbiAgdG8oY2hhbm5lbCkge1xuICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHdpdGhUZXh0KHRleHQsIHVzZU1hcmtkb3duID0gZmFsc2UpIHtcbiAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgIHRoaXMubWFya2Rvd24gPSB1c2VNYXJrZG93bjtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgd2l0aE1hcmtkb3duKHRleHQpIHtcbiAgICByZXR1cm4gdGhpcy53aXRoVGV4dCh0ZXh0LCB0cnVlKTtcbiAgfVxuXG4gIHdpdGhBdHRhY2htZW50KGF0dGFjaG1lbnQpIHtcbiAgICB0aGlzLmF0dGFjaG1lbnRzLnB1c2goYXR0YWNobWVudCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGJ1aWxkKCkge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSB7XG4gICAgICB0ZXh0OiB0aGlzLnRleHQsXG4gICAgICBtYXJrZG93bjogdGhpcy5tYXJrZG93bixcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMuY2hhbm5lbCkge1xuICAgICAgbWVzc2FnZS5jaGFubmVsID0gdGhpcy5jaGFubmVsO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmF0dGFjaG1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIG1lc3NhZ2UuYXR0YWNobWVudHMgPSBbXTtcbiAgICAgIHRoaXMuYXR0YWNobWVudHMuZm9yRWFjaCgoYXR0YWNobWVudCkgPT4ge1xuICAgICAgICBpZiAoIWF0dGFjaG1lbnQudGl0bGUgJiYgIWF0dGFjaG1lbnQudGV4dCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignYXR0YWNobWVudCB0aXRsZSBvciB0ZXh0IGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgbWVzc2FnZS5hdHRhY2htZW50cy5wdXNoKGF0dGFjaG1lbnQpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIHdpdGhUZXh0OiAodGV4dCwgdXNlTWFya2Rvd24pID0+IChuZXcgQnVpbGRlcigpKS53aXRoVGV4dCh0ZXh0LCB1c2VNYXJrZG93biksXG4gIHdpdGhNYXJrZG93bjogdGV4dCA9PiAobmV3IEJ1aWxkZXIoKSkud2l0aE1hcmtkb3duKHRleHQpLFxufTtcbiJdfQ==